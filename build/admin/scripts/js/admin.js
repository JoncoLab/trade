"use strict";var main=function(){var e=$(".navbar").height(),t=$("main"),a=$("table.users, table.lots"),r=$("header .navbar button"),i=$(".users td.ver"),n=i.children(".verification-form"),s=$(".users td.delete .delete-button"),l=$(".lots td.delete .delete-button"),o=function(e){var t=$("#loading");switch(e){case!0:t.show(0,function(){t.css({display:"flex"})});break;case!1:t.hide();break;default:alert("Сталася помилка! Сторінку буде перезавантажено!"),window.location.reload()}},c=$("form .content"),d=c.children(".add-paragr"),p=$(".trade");t.css("margin-top",e+20+"px"),a.DataTable({iDisplayLength:10}),r.click(function(){var e=$(".page-maker"),t=$('[id$="_wrapper"]'),a=$(this).attr("id"),r=$("#DataTables_Table_1_wrapper"),i=$("#DataTables_Table_0_wrapper");switch(e.hide(),t.hide(),$("."+a).toggle(),a){case"users":r.show();break;case"lots":i.show()}}),n.on("submit",function(e){var t=$(this).parents("td"),a=t.siblings(".id").text(),r=$(this).children(".set-trader-id").val(),i=$("body");return o(!0),$.ajax({url:"scripts/php/admin-verify.php",dataType:"html",method:"POST",data:{id:a,traderId:r},success:function(e){o(!1),i.prepend(e)},error:function(){o(!1),alert("Не вдається з'єднатися з базою даних! Сторінку буде перезавантажено!"),window.location.reload()}}),e.preventDefault()}),s.click(function(){var e=$(this).parent().siblings(".id").text(),t=$(this).parentsUntil("tbody");o(!0),$.ajax({url:"scripts/php/admin-delete-user.php",data:{userId:e},method:"post",error:function(){o(!1),alert("Не вдається з'єднатися з базою даних! Сторінку буде перезавантажено!"),window.location.reload()},success:function(){o(!1),t.remove()}})}),l.click(function(){var e=$(this).parent().siblings(".id").text(),t=$(this).parentsUntil("tbody");o(!0),$.ajax({url:"scripts/php/admin-delete-lot.php",data:{lotId:e},method:"post",error:function(){o(!1),alert("Не вдається з'єднатися з базою даних! Сторінку буде перезавантажено!"),window.location.reload()},success:function(){o(!1),t.remove()}})}),d.click(function(){var e=$(".content textarea").val(),t=c.children("textarea"),a=$(".clear"),r=$(".watch");""!==e&&(c.append('<div class="new-paragr"><button class="remove-paragr" type="button">Стерти</button><button class="edit-paragr" type="button">Редаг</button><button type="button" class="edited">OK</button><p class="paragraph">'+e+"</p></div>"),t.val(""));var i=$(".content .new-paragr"),n=i.children(".edit-paragr"),s=i.children(".edited"),l=i.children(".remove-paragr");a.click(function(){t.val("")}),n.unbind().on("click",function(){var e=$(this),t=e.siblings("p").html(),a=e.siblings("textarea, p"),r=e.siblings(".edited");a.remove(),e.parent().prepend('<textarea autofocus rows="12" tabindex="1">'+t+"</textarea>"),e.hide(),r.show(),e.siblings("textarea").focus()}),s.click(function(){var e=$(this),t=e.siblings("textarea").text();""!==t&&(e.siblings("p").remove(),e.parent().append("<p>"+t+"</p>"),e.hide(),e.siblings("textarea").remove(),e.siblings(".edit-paragr").show())}),l.click(function(){$(this).parent().remove()}),r.on("click",function(){var e=$("#header"),t=e.val(),a="<h2>"+t+"</h2>",r="";if(i.each(function(){r=r+"<p>"+$(this).children("p").html()+"</p>"}),0!==i.length&&""!==t){var n="<article class='preview'><span class='back' style='color: grey; float: right;'>Повернутись - подвійний клік по статті</span>"+a+r+"</article>",s=$("article.preview"),l=$("fieldset");l.hide(),s.remove(),$("form.write-article").append(n)}else if(""==t)return e.toggleClass("error"),!1;$("article").focus(),s.dblclick(function(){$(this).remove(),l.show()})})}),p.submit(function(e){var t=$(this).find(".form-item"),a=t.has("input:checked"),r=$("#sellers"),i=a.length;if(0==i)alert("Жодного продавця не вибрано!"),e.preventDefault();else{var n="";a.each(function(e){n+=$(this).children(".seller").text(),e!=i-1&&(n+=",")}),r.val(n)}})};$(document).ready(main);